Search.setIndex({"docnames": ["README", "intro", "notebooks/1_data_analysis", "notebooks/2_data_preparation", "notebooks/3_model_training", "notebooks/4_model_validation"], "filenames": ["README.md", "intro.md", "notebooks\\1_data_analysis.ipynb", "notebooks\\2_data_preparation.ipynb", "notebooks\\3_model_training.ipynb", "notebooks\\4_model_validation.ipynb"], "titles": ["Line detection", "Cuting line detection of chicory", "Data analysis", "Data preparation", "Model training", "Model validation"], "terms": {"config": 0, "contain": [0, 4], "paramet": [0, 4, 5], "file": [0, 3, 4, 5], "ar": [0, 3, 5], "us": [0, 4], "script": [0, 2, 3, 4], "labelbox": 0, "render": 0, "i": [0, 4, 5], "default": 0, "locat": 0, "store": 0, "imag": [0, 2, 3, 4, 5], "label": [0, 2, 4, 5], "well": 0, "panda": [0, 3, 4, 5], "datafram": [0, 3], "all": [0, 2, 3, 4, 5], "notebook": 0, "jupyt": [0, 4, 5], "transfer": 0, "knowledg": 0, "broad": 0, "audienc": 0, "result": [0, 4], "csv": [0, 3, 4, 5], "execut": 0, "softwar": 0, "util": [0, 4], "py": [0, 4, 5], "neccesari": 0, "function": [0, 4, 5], "test": [0, 3], "thi": [0, 2, 3, 4, 5], "packag": [0, 4, 5], "In": [0, 5], "loop": [0, 2, 4], "over": [0, 2, 4], "216": [0, 3, 5], "entri": 0, "json": 0, "from": [0, 4, 5], "For": 0, "everi": 0, "download": [0, 5], "retriev": [0, 4], "bound": [0, 2], "box": [0, 2], "convert": [0, 2, 4, 5], "format": [0, 3, 4, 5], "xmin": 0, "ymin": 0, "xmax": 0, "ymax": 0, "x1": [0, 4], "y1": [0, 4], "x2": [0, 4], "y2": [0, 4], "It": [0, 5], "save": [0, 3, 4], "respect": 0, "id": 0, "txt": [0, 2, 4, 5], "The": 0, "total": [0, 3, 4], "correspond": [0, 4], "To": 0, "visual": [0, 5], "correct": 0, "plot": [0, 4], "annot": 0, "red": [0, 2, 5], "cut": [0, 2], "green": [0, 2], "also": 0, "carthesian": 0, "polar": 0, "coordin": 0, "calcul": [0, 4], "encod": 0, "decod": 0, "drawn": 0, "correctenn": 0, "ground": [0, 2, 4, 5], "truth": [0, 2, 4, 5], "need": [0, 5], "same": 0, "two": [0, 2, 4], "point": [0, 2, 4, 5], "make": 0, "up": 0, "slope": [0, 2, 5], "an": [0, 2, 3, 5], "intercept": [0, 2, 5], "obtain": [0, 3], "infinit": 0, "which": 0, "better": 0, "represent": 0, "when": [0, 4], "trainig": 0, "neural": [0, 4], "network": [0, 4], "thei": 0, "rho": 0, "theta": 0, "further": 0, "co": 0, "sin": 0, "back": 0, "abl": 0, "draw": [0, 2, 5], "them": 0, "again": 0, "violet": [0, 2], "If": 0, "collinear": 0, "step": [0, 4], "split": [0, 2, 3, 4, 5], "so": 0, "we": [0, 3, 5], "have": [0, 5], "70": [0, 3], "151": [0, 3], "15": [0, 3], "32": [0, 3], "33": [0, 3], "path": [0, 2, 3, 4, 5], "three": 0, "train_data": [0, 3, 4], "valid_data": [0, 3, 4], "test_data": [0, 3, 5], "These": 0, "later": 0, "feed": 0, "pretrain": [0, 4], "resnet18": [0, 4], "architectur": 0, "where": 0, "keep": 0, "featur": [0, 4], "layer": [0, 4], "remov": 0, "classif": 0, "add": 0, "new": [0, 4], "untrain": 0, "output": [0, 4], "neuron": [0, 4], "one": 0, "predict": [0, 4, 5], "50": [0, 3], "epoch": [0, 4, 5], "batch": [0, 4, 5], "size": [0, 3, 4], "16": [0, 4, 5], "learn": [0, 4], "rate": 0, "0": [0, 2, 3, 4, 5], "01": [0, 4, 5], "momentum": 0, "9": [0, 4], "befor": 0, "being": 0, "fed": 0, "sever": 0, "augment": [0, 4, 5], "perform": 0, "albument": [0, 4, 5], "especi": 0, "resiz": [0, 4, 5], "224x224": 0, "normal": [0, 4, 5], "tensor": [0, 4], "appli": [0, 4], "transform": [0, 4, 5], "As": 0, "loss": [0, 4], "root": 0, "mean": [0, 4, 5], "squar": 0, "error": [0, 4, 5], "comput": [0, 4], "dataset": [0, 3, 4, 5], "rmse": [0, 4], "data": [1, 4, 5], "analysi": 1, "prepar": 1, "model": 1, "train": [1, 3, 5], "valid": [1, 3, 4], "goe": 2, "through": 2, "line": [2, 4, 5], "import": [2, 3, 4, 5], "glob": [2, 3], "cv2": [2, 4, 5], "numpi": [2, 4, 5], "np": [2, 4, 5], "matplotlib": [2, 4, 5], "pyplot": [2, 4, 5], "plt": [2, 4, 5], "get": [2, 3, 4, 5], "name": [2, 3, 4, 5], "img_path": [2, 4, 5], "jpg": [2, 3], "first": [2, 4], "ten": 2, "10": [2, 4, 5], "read": [2, 4, 5], "im": 2, "imread": [2, 4, 5], "cvtcolor": [2, 4, 5], "color_bgr2rgb": [2, 4, 5], "height": [2, 5], "width": [2, 5], "depth": 2, "shape": [2, 4, 5], "kei": [2, 4, 5], "1": [2, 4, 5], "label_fil": [2, 4, 5], "open": [2, 4, 5], "r": [2, 4, 5], "labeldata": [2, 4, 5], "line_label": 2, "arrai": [2, 4], "float": [2, 4, 5], "4": [2, 4, 5], "5": [2, 3, 4, 5], "6": [2, 4, 5], "7": [2, 3, 4, 5], "rectangl": [2, 5], "int": [2, 3, 5], "2": [2, 4, 5], "3": [2, 4, 5], "255": [2, 5], "base": [2, 4, 5], "els": [2, 4, 5], "b": [2, 4, 5], "creat": [2, 4, 5], "start_point": [2, 5], "end_point": [2, 5], "extend": [2, 5], "color": [2, 5], "thick": [2, 5], "show": [2, 5], "imshow": [2, 5], "set": [3, 4, 5], "includ": 3, "filepath": 3, "random": 3, "pd": [3, 4, 5], "image_path": 3, "shuffl": [3, 4], "prevent": 3, "repetit": 3, "val": 3, "30": 3, "train_image_path": 3, "len": [3, 4], "valid_image_path": 3, "futher": 3, "valid_image_paths_": 3, "test_image_path": 3, "list": 3, "df_train": [3, 4], "column": 3, "path_nam": [3, 4, 5], "df_valid": [3, 4], "df_test": [3, 5], "local": 3, "to_pickl": 3, "print": [3, 4], "There": 3, "str": [3, 4, 5], "nafter": 3, "n": 3, "ttrain": 3, "tvalid": 3, "ttest": 3, "after": 3, "net": 4, "form": 4, "curv": 4, "math": 4, "torch": [4, 5], "nn": [4, 5], "A": [4, 5], "torchvis": [4, 5], "f": [4, 5], "dataload": 4, "pytorch": [4, 5], "totensorv2": [4, 5], "c": [4, 5], "python39": [4, 5], "lib": [4, 5], "site": [4, 5], "tqdm": [4, 5], "auto": [4, 5], "21": [4, 5], "tqdmwarn": [4, 5], "iprogress": [4, 5], "found": [4, 5], "pleas": [4, 5], "updat": [4, 5], "ipywidget": [4, 5], "see": [4, 5], "http": [4, 5], "readthedoc": [4, 5], "io": [4, 5], "en": [4, 5], "stabl": [4, 5], "user_instal": [4, 5], "html": [4, 5], "autonotebook": [4, 5], "notebook_tqdm": [4, 5], "check": [4, 5], "graphic": [4, 5], "card": [4, 5], "cuda": [4, 5], "avail": [4, 5], "pc": [4, 5], "devic": [4, 5], "current_devic": [4, 5], "is_avail": [4, 5], "cpu": [4, 5], "learning_r": [4, 5], "batch_siz": [4, 5], "class": 4, "impement": 4, "def": [4, 5], "__init__": [4, 5], "self": 4, "fals": 4, "__len__": 4, "return": [4, 5], "__getitem__": 4, "idx": 4, "sampl": 4, "rgb": 4, "space": 4, "keypoint": [4, 5], "defin": [4, 5], "pipelin": [4, 5], "compos": [4, 5], "advancedblur": 4, "randomgravel": 4, "isonois": 4, "randomrotate90": 4, "p": 4, "horizontalflip": 4, "randombrightnesscontrast": 4, "224": [4, 5], "485": [4, 5], "456": [4, 5], "406": [4, 5], "std": [4, 5], "229": [4, 5], "225": [4, 5], "keypoint_param": [4, 5], "keypointparam": [4, 5], "xy": [4, 5], "remove_invis": [4, 5], "true": [4, 5], "transformed_imag": [4, 5], "transformed_keypoint": 4, "target": 4, "load": [4, 5], "read_pickl": [4, 5], "train_d": 4, "valid_d": 4, "loader": 4, "extract": 4, "certain": 4, "train_dl": 4, "valid_dl": 4, "angl": 4, "between": 4, "degre": 4, "loss_cos_fun": 4, "pred": [4, 5], "y": [4, 5], "x": 4, "differ": 4, "delta_x_pr": 4, "delta_y_pr": 4, "delta_x_i": 4, "delta_y_i": 4, "stack": 4, "both": 4, "sum": 4, "anl": 4, "aco": 4, "cosine_similar": 4, "dim": 4, "180": 4, "pi": 4, "euclidean": 4, "distanc": 4, "center": 4, "loss_rmse_fun": 4, "onli": 4, "xy1_pr": 4, "y_centerx": 4, "y_centeri": 4, "y_center": 4, "sqrt": 4, "implement": 4, "train_model": 4, "optim": 4, "training_loss": 4, "validation_loss": 4, "best_model": 4, "best_loss": 4, "inf": 4, "rang": 4, "debug": 4, "do": 4, "phase": 4, "each": 4, "state": 4, "mode": [4, 5], "eval": [4, 5], "evalu": [4, 5], "reset": 4, "number": 4, "running_loss": 4, "num_sampl": 4, "iter": 4, "input": 4, "_": [4, 5], "loss_rmse_valu": 4, "loss_cos_valu": 4, "item": 4, "zero_grad": 4, "clear": 4, "out": 4, "gradient": 4, "backward": 4, "backpropag": 4, "whole": 4, "divid": 4, "dataset_loss": 4, "append": 4, "train_loss": 4, "3f": 4, "elif": 4, "val_loss": 4, "last": [4, 5], "fulli": 4, "connect": 4, "total_featur": 4, "fc": 4, "in_featur": 4, "replac": 4, "final": 4, "four": 4, "sequenti": 4, "linear": 4, "link": 4, "adam": 4, "lr": 4, "236": 4, "263": 4, "1906812": 4, "637": 4, "235": 4, "720": 4, "1966": 4, "451": 4, "232": 4, "222": 4, "299": 4, "996": 4, "737": 4, "199": 4, "214": [4, 5], "425": 4, "198": 4, "576": 4, "197": 4, "297": 4, "200": 4, "321": 4, "187": 4, "598": 4, "161": 4, "816": 4, "8": 4, "182": 4, "568": 4, "143": 4, "976": 4, "166": 4, "152": 4, "618": 4, "158": 4, "848": 4, "458": 4, "876": 4, "model_nam": 4, "model_": [4, 5], "pt": [4, 5], "fig": 4, "figur": 4, "mask": 4, "1000": 4, "markers": 4, "titl": 4, "xlabel": 4, "ylabel": 4, "cosin": 4, "similar": 4, "legend": 4, "0x1710aab79a0": 4, "model_file_nam": 5, "ret": 5, "draw_extended_lin": 5, "col": 5, "total_rms": 5, "row": 5, "iterrow": 5, "subplot": 5, "channel": 5, "a1": 5, "b1": 5, "unsqueez": 5, "solv": 5, "miss": 5, "dimens": 5, "detach": 5, "scale": 5, "account": 5, "a2": 5, "b2": 5, "stop": 5, "break": 5, "runtimeerror": 5, "traceback": 5, "most": 5, "recent": 5, "call": 5, "cell": 5, "40": 5, "37": 5, "39": 5, "41": 5, "43": 5, "_lazy_init": 5, "212": 5, "rais": 5, "assertionerror": 5, "213": 5, "libcudart": 5, "unavail": 5, "look": 5, "like": 5, "you": 5, "broken": 5, "build": 5, "throw": 5, "": 5, "driver": 5, "initi": 5, "gpu": 5, "215": 5, "ani": 5, "other": 5, "occur": 5, "_c": 5, "_cuda_init": 5, "217": 5, "some": 5, "queu": 5, "mai": 5, "reentrantli": 5, "218": 5, "just": 5, "without": 5, "case": 5, "219": 5, "howev": 5, "must": 5, "let": 5, "thread": 5, "220": 5, "_tl": 5, "is_initi": 5, "nvidia": 5, "your": 5, "system": 5, "instal": 5, "www": 5, "com": 5, "index": 5, "aspx": 5}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"line": [0, 1], "detect": [0, 1], "folder": 0, "structur": 0, "content": 0, "data": [0, 2, 3], "gener": 0, "analysi": [0, 2], "prepar": [0, 3], "model": [0, 4, 5], "train": [0, 4], "valid": [0, 5], "cute": 1, "chicori": 1}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 57}, "alltitles": {"Line detection": [[0, "line-detection"]], "Folder structure": [[0, "folder-structure"]], "Content": [[0, "content"]], "Data generation": [[0, "data-generation"]], "Data analysis": [[0, "data-analysis"], [2, "data-analysis"]], "Data preparation": [[0, "data-preparation"], [3, "data-preparation"]], "Model training": [[0, "model-training"], [4, "model-training"]], "Model validation": [[0, "model-validation"], [5, "model-validation"]], "Cuting line detection of chicory": [[1, "cuting-line-detection-of-chicory"]]}, "indexentries": {}})