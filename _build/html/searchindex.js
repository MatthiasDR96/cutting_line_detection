Search.setIndex({"docnames": ["README", "intro", "notebooks/1_data_analysis", "notebooks/2_data_preparation", "notebooks/3_model_training", "notebooks/4_model_validation"], "filenames": ["README.md", "intro.md", "notebooks\\1_data_analysis.ipynb", "notebooks\\2_data_preparation.ipynb", "notebooks\\3_model_training.ipynb", "notebooks\\4_model_validation.ipynb"], "titles": ["Line detection", "Cutting line detection of chicory", "Data analysis", "Data preparation", "Model training", "Model validation"], "terms": {"config": 0, "contain": [0, 4], "paramet": [0, 4, 5], "file": [0, 3, 4], "ar": [0, 1, 3, 4], "us": [0, 1, 4], "script": [0, 1, 2, 3, 4], "labelbox": 0, "render": 0, "i": [0, 1, 4, 5], "default": [0, 4], "locat": 0, "store": 0, "imag": [0, 1, 2, 3, 4, 5], "label": [0, 1, 2, 4, 5], "well": [0, 1, 4], "panda": [0, 3, 4, 5], "datafram": [0, 3], "all": [0, 1, 2, 3, 4, 5], "notebook": [0, 1], "jupyt": [0, 4, 5], "transfer": 0, "knowledg": 0, "broad": 0, "audienc": 0, "result": [0, 4], "csv": [0, 3, 4, 5], "execut": 0, "softwar": 0, "util": [0, 4], "py": [0, 4, 5], "neccesari": 0, "function": [0, 1, 4, 5], "test": [0, 1, 3], "thi": [0, 1, 2, 3, 4, 5], "packag": [0, 4, 5], "In": [0, 1, 4], "loop": [0, 1, 2, 4], "over": [0, 1, 2, 4], "216": [0, 1, 3], "entri": 0, "json": 0, "from": [0, 1, 4, 5], "For": [0, 4], "everi": [0, 4], "download": 0, "retriev": [0, 4], "bound": [0, 1, 2], "box": [0, 1, 2], "convert": [0, 2, 4, 5], "format": [0, 1, 3, 4, 5], "xmin": 0, "ymin": 0, "xmax": 0, "ymax": 0, "x1": [0, 1, 4], "y1": [0, 1, 4], "x2": [0, 1, 4], "y2": [0, 1, 4], "It": [0, 4], "save": [0, 3, 4], "respect": 0, "id": 0, "txt": [0, 2, 4, 5], "The": [0, 1, 4], "total": [0, 3, 4], "correspond": [0, 4], "To": 0, "visual": [0, 4, 5], "correct": 0, "plot": [0, 4], "annot": 0, "red": [0, 2, 5], "cut": [0, 2, 4], "green": [0, 2], "also": [0, 4], "carthesian": 0, "polar": 0, "coordin": 0, "calcul": [0, 4], "encod": 0, "decod": 0, "drawn": 0, "correctenn": 0, "ground": [0, 2, 4, 5], "truth": [0, 2, 4, 5], "need": 0, "same": [0, 4], "two": [0, 1, 2, 4], "point": [0, 1, 2, 4, 5], "make": [0, 4], "up": 0, "slope": [0, 2, 5], "an": [0, 2, 3, 4, 5], "intercept": [0, 2, 5], "obtain": [0, 3, 4], "infinit": 0, "which": 0, "better": 0, "represent": 0, "when": [0, 4], "trainig": 0, "neural": [0, 1, 4], "network": [0, 1, 4], "thei": 0, "rho": 0, "theta": 0, "further": 0, "co": 0, "sin": 0, "back": 0, "abl": [0, 4], "draw": [0, 1, 2, 5], "them": 0, "again": 0, "violet": [0, 2], "If": 0, "collinear": [0, 4], "step": [0, 4], "split": [0, 1, 2, 3, 4, 5], "so": 0, "we": [0, 3, 4], "have": [0, 4], "70": [0, 3, 4], "151": [0, 3, 4], "15": [0, 3, 4], "32": [0, 3, 4], "33": [0, 3, 4], "path": [0, 2, 3, 4, 5], "three": 0, "train_data": [0, 3, 4], "valid_data": [0, 3, 4], "test_data": [0, 3, 5], "These": [0, 4], "later": [0, 4], "feed": 0, "pretrain": [0, 1, 4], "resnet18": [0, 1, 4], "architectur": 0, "where": 0, "keep": 0, "featur": [0, 4], "layer": [0, 4], "remov": 0, "classif": 0, "add": 0, "new": [0, 4], "untrain": [0, 4], "output": [0, 1, 4], "neuron": [0, 4], "one": [0, 4], "predict": [0, 1, 4, 5], "50": [0, 3, 4], "epoch": [0, 4, 5], "batch": [0, 4, 5], "size": [0, 3, 4], "16": [0, 4, 5], "learn": [0, 1, 4], "rate": 0, "0": [0, 2, 3, 4, 5], "01": [0, 4, 5], "momentum": 0, "9": [0, 4], "befor": [0, 4], "being": 0, "fed": 0, "sever": 0, "augment": [0, 4, 5], "perform": 0, "albument": [0, 4, 5], "especi": 0, "resiz": [0, 4, 5], "224x224": 0, "normal": [0, 4, 5], "tensor": [0, 4], "appli": [0, 4], "transform": [0, 4, 5], "As": [0, 1], "loss": [0, 4], "root": [0, 1], "mean": [0, 4, 5], "squar": 0, "error": [0, 4], "comput": [0, 4], "dataset": [0, 1, 3, 4, 5], "rmse": [0, 4], "data": [1, 4, 5], "analysi": 1, "prepar": 1, "model": 1, "train": [1, 3, 5], "valid": [1, 3, 4], "goe": 2, "through": 2, "line": [2, 4, 5], "import": [2, 3, 4, 5], "glob": [2, 3], "cv2": [2, 4, 5], "numpi": [2, 4, 5], "np": [2, 4, 5], "matplotlib": [2, 4, 5], "pyplot": [2, 4, 5], "plt": [2, 4, 5], "get": [2, 3, 4, 5], "name": [2, 3, 4, 5], "img_path": [2, 4, 5], "jpg": [2, 3], "first": [1, 2, 4], "ten": 2, "10": [2, 4, 5], "read": [2, 4, 5], "im": 2, "imread": [2, 4, 5], "cvtcolor": [2, 4, 5], "color_bgr2rgb": [2, 4, 5], "height": [2, 5], "width": [2, 5], "depth": 2, "shape": [2, 4, 5], "kei": [2, 4, 5], "1": [2, 4, 5], "label_fil": [2, 4, 5], "open": [2, 4, 5], "r": [2, 4, 5], "labeldata": [2, 4, 5], "line_label": 2, "arrai": [2, 4], "float": [2, 4, 5], "4": [2, 4, 5], "5": [2, 3, 4, 5], "6": [2, 4, 5], "7": [2, 3, 4, 5], "rectangl": [2, 5], "int": [2, 3, 5], "2": [2, 4, 5], "3": [2, 4, 5], "255": [2, 5], "base": [2, 4, 5], "els": [2, 4, 5], "b": [2, 4, 5], "creat": [2, 4, 5], "start_point": [2, 5], "end_point": [2, 5], "extend": [2, 5], "color": [2, 5], "thick": [2, 5], "show": [1, 2, 5], "imshow": [2, 5], "set": [1, 3, 4, 5], "includ": 3, "filepath": 3, "random": 3, "pd": [3, 4, 5], "image_path": 3, "shuffl": [3, 4], "prevent": 3, "repetit": 3, "val": 3, "30": [3, 4], "train_image_path": 3, "len": [3, 4], "valid_image_path": 3, "futher": 3, "valid_image_paths_": 3, "test_image_path": 3, "list": 3, "df_train": [3, 4], "column": 3, "path_nam": [3, 4, 5], "df_valid": [3, 4], "df_test": [3, 5], "local": [3, 4], "to_pickl": 3, "print": [3, 4], "There": 3, "str": [3, 4, 5], "nafter": 3, "n": 3, "ttrain": 3, "tvalid": 3, "ttest": 3, "after": [3, 4], "net": 4, "form": 4, "curv": [1, 4], "math": 4, "torch": [4, 5], "nn": [4, 5], "A": [1, 4, 5], "torchvis": [4, 5], "f": [4, 5], "dataload": 4, "pytorch": [4, 5], "totensorv2": [4, 5], "c": [4, 5], "python39": [4, 5], "lib": [4, 5], "site": [4, 5], "tqdm": [4, 5], "auto": [4, 5], "21": [4, 5], "tqdmwarn": [4, 5], "iprogress": [4, 5], "found": [4, 5], "pleas": [4, 5], "updat": [4, 5], "ipywidget": [4, 5], "see": [4, 5], "http": [4, 5], "readthedoc": [4, 5], "io": [4, 5], "en": [4, 5], "stabl": [4, 5], "user_instal": [4, 5], "html": [4, 5], "autonotebook": [4, 5], "notebook_tqdm": [4, 5], "check": [4, 5], "graphic": [4, 5], "card": [4, 5], "cuda": [4, 5], "avail": [1, 4, 5], "pc": [4, 5], "devic": [4, 5], "current_devic": [4, 5], "is_avail": [4, 5], "cpu": [4, 5], "learning_r": [4, 5], "batch_siz": [4, 5], "class": 4, "impement": 4, "def": [4, 5], "__init__": 4, "self": 4, "fals": 4, "__len__": 4, "return": [4, 5], "__getitem__": 4, "idx": 4, "sampl": 4, "rgb": 4, "space": 4, "keypoint": [4, 5], "defin": [4, 5], "pipelin": [4, 5], "compos": [4, 5], "advancedblur": 4, "randomgravel": 4, "isonois": 4, "randomrotate90": 4, "p": 4, "horizontalflip": 4, "randombrightnesscontrast": 4, "224": [4, 5], "485": [4, 5], "456": [4, 5], "406": [4, 5], "std": [4, 5], "229": [4, 5], "225": [4, 5], "keypoint_param": [4, 5], "keypointparam": [4, 5], "xy": [4, 5], "remove_invis": [4, 5], "true": [4, 5], "transformed_imag": [4, 5], "transformed_keypoint": 4, "target": 4, "load": [4, 5], "read_pickl": [4, 5], "train_d": 4, "valid_d": 4, "loader": 4, "extract": 4, "certain": 4, "train_dl": 4, "valid_dl": 4, "angl": [1, 4], "between": [1, 4], "degre": [1, 4], "loss_cos_fun": 4, "pred": [4, 5], "y": [4, 5], "x": 4, "differ": 4, "delta_x_pr": 4, "delta_y_pr": 4, "delta_x_i": 4, "delta_y_i": 4, "stack": 4, "both": 4, "sum": [1, 4], "anl": 4, "aco": 4, "cosine_similar": 4, "dim": 4, "180": 4, "pi": 4, "euclidean": [1, 4], "distanc": [1, 4], "center": [1, 4], "loss_rmse_fun": 4, "onli": 4, "xy1_pr": 4, "y_centerx": 4, "y_centeri": 4, "y_center": 4, "sqrt": 4, "implement": 4, "train_model": 4, "optim": [1, 4], "training_loss": 4, "validation_loss": 4, "best_model": 4, "best_loss": 4, "inf": 4, "rang": 4, "debug": 4, "do": 4, "phase": 4, "each": 4, "state": 4, "mode": [4, 5], "eval": [4, 5], "evalu": [4, 5], "reset": 4, "number": 4, "running_loss": 4, "num_sampl": 4, "iter": 4, "input": 4, "_": [4, 5], "loss_rmse_valu": 4, "loss_cos_valu": 4, "item": 4, "zero_grad": 4, "clear": 4, "out": 4, "gradient": 4, "backward": 4, "backpropag": 4, "whole": 4, "divid": 4, "dataset_loss": 4, "append": 4, "train_loss": 4, "3f": 4, "elif": 4, "val_loss": 4, "last": [1, 4], "fulli": 4, "connect": 4, "total_featur": 4, "fc": 4, "in_featur": 4, "replac": 4, "final": 4, "four": 4, "sequenti": 4, "linear": 4, "link": 4, "adam": 4, "lr": 4, "236": [], "263": [], "1906812": [], "637": [], "235": [], "720": [], "1966": [], "451": 4, "232": [], "222": [], "299": [], "996": [], "737": [], "199": [], "214": 4, "425": [], "198": [], "576": [], "197": 4, "297": [], "200": [], "321": [], "187": 4, "598": [], "161": 4, "816": [], "8": 4, "182": 4, "568": [], "143": 4, "976": [], "166": [], "152": [], "618": [], "158": [], "848": [], "458": [], "876": [], "model_nam": 4, "model_": [4, 5], "pt": [4, 5], "fig": 4, "figur": 4, "mask": 4, "1000": 4, "markers": 4, "titl": 4, "xlabel": 4, "ylabel": 4, "cosin": 4, "similar": 4, "legend": 4, "0x1710aab79a0": [], "model_file_nam": 5, "ret": 5, "draw_extended_lin": 5, "col": 5, "total_rms": 5, "row": 5, "iterrow": 5, "subplot": 5, "channel": 5, "a1": 5, "b1": 5, "unsqueez": 5, "solv": 5, "miss": 5, "dimens": 5, "detach": 5, "scale": 5, "account": 5, "a2": 5, "b2": 5, "stop": 5, "break": 5, "runtimeerror": [], "traceback": [], "most": [], "recent": [], "call": 4, "cell": [], "40": 4, "37": 4, "39": 4, "41": 4, "43": 4, "_lazy_init": [], "212": 4, "rais": [], "assertionerror": [], "213": [], "libcudart": [], "unavail": [], "look": [], "like": [], "you": [], "broken": [], "build": [], "throw": [], "": [], "driver": [], "initi": 4, "gpu": [], "215": [], "ani": [], "other": 4, "occur": [], "_c": [], "_cuda_init": [], "217": [], "some": [1, 4], "queu": [], "mai": [], "reentrantli": [], "218": 4, "just": [], "without": [], "case": [], "219": [], "howev": [], "must": [], "let": [], "thread": [], "220": 4, "_tl": [], "is_initi": [], "nvidia": [], "your": [], "system": [], "instal": [], "www": [], "com": [], "index": [], "aspx": [], "loaf": 1, "determin": 1, "uncut": 1, "ha": 1, "cost": [1, 4], "second": [1, 4], "third": 1, "testset": 1, "time": 4, "weight": 4, "adjust": 4, "reduc": 4, "process": 4, "boolean": 4, "usag": 4, "off": 4, "below": 4, "how": 4, "sent": 4, "By": 4, "activ": 4, "undergo": 4, "doe": 4, "send": 4, "next": 4, "databas": 4, "assign": 4, "should": 4, "reflect": 4, "real": 4, "situat": 4, "properli": 4, "predefin": 4, "can": 4, "repres": 4, "sure": 4, "li": 4, "close": 4, "possibl": 4, "elimin": 4, "neg": 4, "effect": 4, "fact": 4, "fix": 4, "order": 4, "sometim": 4, "right": 4, "side": 4, "chicori": 4, "left": 4, "take": 4, "invers": 4, "valu": 4, "main": 4, "And": 4, "accord": 4, "pass": 4, "averag": 4, "datasampl": 4, "code": 4, "abov": 4, "start": 4, "490": [], "154664": [], "181": [], "206": [], "907": [], "12862": [], "728": [], "544": [], "750": 4, "190": [], "484": [], "260": [], "695": 4, "185": [], "771": [], "201": 4, "392": [], "179": [], "698": [], "247": [], "006": 4, "169": [], "462": [], "209": [], "614": [], "393": 4, "171": 4, "634": [], "153": [], "794": [], "159": 4, "830": [], "135": [], "550": [], "168": [], "413": [], "0x1f166e4c340": [], "100": 4, "226": 4, "150": 4, "235162": 4, "743": 4, "211": 4, "857": 4, "7366": 4, "656": 4, "899": 4, "989": 4, "934": 4, "178": 4, "792": 4, "174": 4, "735": 4, "768": 4, "340": 4, "154": 4, "658": 4, "155": 4, "246": 4, "125": 4, "259": 4, "120": 4, "592": 4, "106": 4, "594": 4, "98": 4, "147": 4, "77": 4, "613": 4, "79": 4, "749": 4, "11": 4, "58": 4, "398": 4, "75": 4, "772": 4, "12": 4, "55": 4, "319": 4, "64": 4, "13": 4, "48": 4, "832": 4, "67": 4, "499": 4, "14": 4, "45": 4, "290": 4, "99": 4, "184": 4, "354": 4, "86": 4, "46": 4, "221": 4, "039": 4, "17": 4, "42": 4, "096": 4, "65": 4, "404": 4, "18": 4, "468": 4, "57": 4, "437": 4, "19": 4, "35": 4, "365": 4, "44": 4, "016": 4, "20": 4, "473": 4, "62": 4, "555": 4, "38": 4, "328": 4, "63": 4, "722": 4, "22": 4, "36": 4, "372": 4, "51": 4, "918": 4, "23": 4, "787": 4, "270": 4, "24": 4, "777": 4, "833": 4, "25": 4, "055": 4, "273": 4, "26": 4, "789": 4, "718": 4, "27": 4, "28": 4, "324": 4, "186": 4, "898": 4, "29": 4, "47": 4, "919": 4, "552": 4, "230": 4, "141": 4, "31": 4, "176": 4, "130": 4, "292": 4, "129": 4, "955": 4, "779": 4, "59": 4, "145": 4, "34": 4, "781": 4, "821": 4, "678": 4, "551": 4, "861": 4, "791": 4, "127": 4, "619": 4, "148": 4, "022": 4, "818": 4, "661": 4, "192": 4, "604": 4, "988": 4, "631": 4, "52": 4, "104": 4, "107": 4, "286": 4, "195": 4, "773": 4, "811": 4, "083": 4, "122": 4, "947": 4, "336": 4, "855": 4, "49": 4, "077": 4, "397": 4, "956": 4, "431": 4, "002": 4, "403": 4, "284": 4, "53": 4, "296": 4, "387": 4, "54": 4, "689": 4, "56": 4, "817": 4, "940": 4, "652": 4, "073": 4, "60": 4, "030": 4, "719": 4, "61": 4, "654": 4, "994": 4, "383": 4, "729": 4, "262": 4, "146": 4, "676": 4, "984": 4, "66": 4, "904": 4, "812": 4, "390": 4, "68": 4, "358": 4, "310": 4, "69": 4, "494": 4, "131": 4, "548": 4, "71": 4, "015": 4, "982": 4, "72": 4, "870": 4, "73": 4, "461": 4, "74": 4, "318": 4, "090": 4, "567": 4, "76": 4, "912": 4, "265": 4, "183": 4, "78": 4, "202": 4, "099": 4, "80": 4, "815": 4, "81": 4, "491": 4, "635": 4, "82": 4, "878": 4, "443": 4, "83": 4, "615": 4, "302": 4, "84": 4, "071": 4, "85": 4, "371": 4, "518": 4, "706": 4, "87": 4, "845": 4, "88": 4, "753": 4, "89": 4, "304": 4, "90": 4, "667": 4, "860": 4, "91": 4, "679": 4, "909": 4, "92": 4, "921": 4, "93": 4, "050": 4, "495": 4, "94": 4, "95": 4, "925": 4, "829": 4, "96": 4, "422": 4, "243": 4, "97": 4, "747": 4, "914": 4, "828": 4, "395": 4, "366": 4, "778": 4, "0x25c2e3a92b0": 4}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"line": [0, 1], "detect": [0, 1], "folder": 0, "structur": 0, "content": 0, "data": [0, 2, 3], "gener": 0, "analysi": [0, 2], "prepar": [0, 3], "model": [0, 4, 5], "train": [0, 4], "valid": [0, 5], "cute": [], "chicori": 1, "cut": 1}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 57}, "alltitles": {"Line detection": [[0, "line-detection"]], "Folder structure": [[0, "folder-structure"]], "Content": [[0, "content"]], "Data generation": [[0, "data-generation"]], "Data analysis": [[0, "data-analysis"], [2, "data-analysis"]], "Data preparation": [[0, "data-preparation"], [3, "data-preparation"]], "Model training": [[0, "model-training"], [4, "model-training"]], "Model validation": [[0, "model-validation"], [5, "model-validation"]], "Cutting line detection of chicory": [[1, "cutting-line-detection-of-chicory"]]}, "indexentries": {}})